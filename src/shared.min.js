const keyTextSize="textSize",keyLineHeight="lineHeight",keyOnOff="onOff",keyFont="font",keyWhitelisted="whitelisted",keyCustomSettings="customSettings",keyCustomFonts="customFonts",keys=["textSize","lineHeight","onOff","font","whitelisted","customSettings","customFonts"],defaultFont="Droid Arabic Naskh",defaultTextSize=125,defaultLineHeight=145,defaultColor="#880E4F",homePage="http://basshelal.github.io/Wudooh",defaultDelay=250,reasonUpdateAllText="updateAllText",reasonInjectCustomFonts="injectCustomFonts",reasonToggleOff="toggleOff",htmlEditables=["textarea","input","text","email","number","search","tel","url","password"],allWudoohFonts=["Droid Arabic Naskh","Noto Naskh Arabic","Arabic Typesetting","Simplified Arabic","Traditional Arabic","Noto Sans Arabic","Noto Kufi Arabic","Aldhabi","Amiri","Amiri Quran","Andalus","Reem Kufi Regular","Scheherazade","Urdu Typesetting","Noto Nastaliq Urdu","Aref Ruqaa","Cairo","Lemonada","Lalezar","Tajawal","Changa","El Messiri","Lateef","Mada","Markazi Text","Mirza","Harmattan","Rakkas","Katibeh","Jomhuria","Shakstah","Mehr Nastaliq","Rooznameh","DecoType Naskh","sans-serif","Times New Roman","Arial","Calibri","Original"],browserName=(()=>{const e=navigator.userAgent.toLowerCase();return e.includes("firefox")?"firefox":e.includes("edg")?"edge":e.includes("opr")||e.includes("opera")?"opera":e.includes("chrome")?"chrome":null})(),isChromium=(()=>"chrome"===browserName||"edge"===browserName||"opera"===browserName)();class CustomSettings{constructor(e,t,r,o){this.url=e,this.textSize=t,this.lineHeight=r,this.font=o}static isValidCustomSettings(e){const t=e.url,r=e.textSize,o=e.lineHeight,s=e.font;return!!t&&"string"==typeof t&&!!r&&"number"==typeof r&&r>=100&&r<=300&&!!o&&"number"==typeof o&&o>=100&&o<=300&&!!s&&"string"==typeof s}static isCustomSettings(e){return!!e&&e.hasOwnProperty("url")&&e.hasOwnProperty("textSize")&&e.hasOwnProperty("lineHeight")&&e.hasOwnProperty("font")&&this.isValidCustomSettings(e)}static isCustomSettingsArray(e){return 0===e.length||e.every(e=>this.isCustomSettings(e))}}class CustomFont{constructor(e,t,r){this.fontName=e,this.localName=t,this.url=r}static injectCSS(e){const t=[];return t.push(`@font-face { font-family: '${e.fontName}';`),(e.url||e.localName)&&t.push("src: "),e.url&&e.localName?t.push(`local('${e.localName}'), url('${e.url}');}\n`):e.localName&&!e.url?t.push(`local('${e.localName}');}\n`):e.url&&!e.localName&&t.push(`url('${e.url}');}\n`),t.join("")}static isFontInstalled(e){var t=document.createElement("span");function r(e){t.style.fontFamily=e,document.body.appendChild(t);let r=t.clientWidth;return document.body.removeChild(t),r}t.innerHTML=Array(100).join("wi"),t.style.cssText=["position:absolute","width:auto","font-size:128px","left:-99999px"].join(" !important;");var o=r("monospace"),s=r("serif"),a=r("sans-serif");return o!==r(e+",monospace")||a!==r(e+",sans-serif")||s!==r(e+",serif")}static async isFontUrlValid(e){return fetch(e).then(e=>e.ok).catch(()=>!1)}static async isFontValid(e){let t=!0,r=!0;return e.localName&&(t=CustomFont.isFontInstalled(e.localName)),e.url&&(r=await CustomFont.isFontUrlValid(e.url)),t&&r}static isValidCustomFont(e){const t=e.fontName,r=e.localName,o=e.url;return!!t&&"string"==typeof t&&!!r&&"string"==typeof r&&!!o&&"string"==typeof o}static isCustomFont(e){return!!e&&e.hasOwnProperty("fontName")&&e.hasOwnProperty("localName")&&e.hasOwnProperty("url")&&this.isValidCustomFont(e)}static isCustomFontsArray(e){return 0===e.length||e.every(e=>this.isCustomFont(e))}}const runtime=(()=>"chrome"===browserName||"edge"===browserName||"opera"===browserName?chrome.runtime:"firefox"===browserName?browser.runtime:void 0)(),sync={get:async(e=null)=>new Promise(t=>{"chrome"===browserName||"edge"===browserName?chrome.storage.sync.get(e,e=>t(e)):"opera"===browserName?chrome.storage.local.get(e,e=>t(e)):"firefox"===browserName&&browser.storage.sync.get(e).then(e=>t(e))}),set:async e=>new Promise(t=>{"chrome"===browserName||"edge"===browserName?chrome.storage.sync.set(e,()=>t()):"opera"===browserName?chrome.storage.local.set(e,()=>t()):"firefox"===browserName&&browser.storage.sync.set(e).then(()=>t())})},tabs={create:async e=>new Promise(t=>{"chrome"===browserName||"edge"===browserName||"opera"===browserName?chrome.tabs.create({url:e},e=>t(e)):"firefox"===browserName&&browser.tabs.create({url:e}).then(e=>t(e))}),queryAllTabs:async()=>new Promise(e=>{"chrome"===browserName||"edge"===browserName||"opera"===browserName?chrome.tabs.query({},t=>e(t)):"firefox"===browserName&&browser.tabs.query({}).then(t=>e(t))}),queryCurrentTab:async()=>new Promise(e=>{"chrome"===browserName||"edge"===browserName||"opera"===browserName?chrome.tabs.query({active:!0,currentWindow:!0},t=>e(t)):"firefox"===browserName&&browser.tabs.query({active:!0,currentWindow:!0}).then(t=>e(t))}),sendMessage(e,t){"chrome"===browserName||"edge"===browserName||"opera"===browserName?chrome.tabs.sendMessage(e,t):"firefox"===browserName&&browser.tabs.sendMessage(e,t)}};async function injectCustomFonts(e){let t=get("wudoohCustomFontsStyle");return t&&(t.textContent="",document.head.removeChild(t),t=null),(t=document.createElement("style")).id="wudoohCustomFontsStyle",e.forEach(e=>{t.textContent=t.textContent.concat(CustomFont.injectCSS(e))}),document.head.append(t),e}function get(e){return document.getElementById(e)}function wait(e,t){return setTimeout(t,e)}Array.prototype.contains=function(e){return-1!==this.indexOf(e)},String.prototype.contains=function(e){return-1!==this.indexOf(e)},Element.prototype.postDelayed=function(e,t){let r=wait(e,()=>{r===this.currentTask&&t.call(this)});this.currentTask=r};