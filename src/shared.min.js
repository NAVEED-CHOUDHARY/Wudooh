const keyTextSize="textSize",keyLineHeight="lineHeight",keyOnOff="onOff",keyFont="font",keyWhitelisted="whitelisted",keyCustomSettings="customSettings",keyCustomFonts="customFonts",keys=["textSize","lineHeight","onOff","font","whitelisted","customSettings","customFonts"],defaultFont="Droid Arabic Naskh",defaultTextSize=125,defaultLineHeight=145,defaultColor="#880E4F",homePage="http://basshelal.github.io/Wudooh",defaultDelay=250,reasonUpdateAllText="updateAllText",reasonInjectCustomFonts="injectCustomFonts",reasonToggleOff="toggleOff",htmlEditables=["textarea","input","text","email","number","search","tel","url","password"],allWudoohFonts=["Droid Arabic Naskh","Noto Naskh Arabic","Arabic Typesetting","Simplified Arabic","Traditional Arabic","Noto Sans Arabic","Noto Kufi Arabic","Aldhabi","Amiri","Amiri Quran","Andalus","Reem Kufi Regular","Scheherazade","Urdu Typesetting","Noto Nastaliq Urdu","Aref Ruqaa","Cairo","Lemonada","Lalezar","Tajawal","Changa","El Messiri","Lateef","Mada","Markazi Text","Mirza","Harmattan","Rakkas","Katibeh","Jomhuria","Shakstah","Mehr Nastaliq","Rooznameh","DecoType Naskh","sans-serif","Times New Roman","Arial","Calibri","Original"],browserName=(()=>{const t=navigator.userAgent.toLowerCase();return t.includes("firefox")?"firefox":t.includes("edg")?"edge":t.includes("opr")||t.includes("opera")?"opera":t.includes("chrome")?"chrome":null})(),isChromium=(()=>"chrome"===browserName||"edge"===browserName||"opera"===browserName)();class CustomSettings{constructor(t,e,s,o){this.url=t,this.textSize=e,this.lineHeight=s,this.font=o}static isValidCustomSettings(t){const e=t.url,s=t.textSize,o=t.lineHeight,n=t.font;return!!e&&"string"==typeof e&&!!s&&"number"==typeof s&&s>=100&&s<=300&&!!o&&"number"==typeof o&&o>=100&&o<=300&&!!n&&"string"==typeof n}static isCustomSettings(t){return!!t&&t.hasOwnProperty("url")&&t.hasOwnProperty("textSize")&&t.hasOwnProperty("lineHeight")&&t.hasOwnProperty("font")&&this.isValidCustomSettings(t)}static isCustomSettingsArray(t){return 0===t.length||t.every(t=>this.isCustomSettings(t))}}class CustomFont{constructor(t,e,s){this.fontName=t,this.localName=e,this.url=s}static injectCSS(t){const e=[];return e.push(`@font-face { font-family: '${t.fontName}';`),(t.url||t.localName)&&e.push("src: "),t.url&&t.localName?e.push(`local('${t.localName}'), url('${t.url}');}\n`):t.localName&&!t.url?e.push(`local('${t.localName}');}\n`):t.url&&!t.localName&&e.push(`url('${t.url}');}\n`),e.join("")}static isFontInstalled(t){var e=document.createElement("span");function s(t){e.style.fontFamily=t,document.body.appendChild(e);let s=e.clientWidth;return document.body.removeChild(e),s}e.innerHTML=Array(100).join("wi"),e.style.cssText=["position:absolute","width:auto","font-size:128px","left:-99999px"].join(" !important;");var o=s("monospace"),n=s("serif"),r=s("sans-serif");return o!==s(t+",monospace")||r!==s(t+",sans-serif")||n!==s(t+",serif")}static async isFontUrlValid(t){return fetch(t).then(t=>t.ok).catch(()=>!1)}static async isFontValid(t){let e=!0,s=!0;return t.localName&&(e=CustomFont.isFontInstalled(t.localName)),t.url&&(s=await CustomFont.isFontUrlValid(t.url)),e&&s}static isValidCustomFont(t){const e=t.fontName,s=t.localName,o=t.url;return!!e&&"string"==typeof e&&!!s&&"string"==typeof s&&!!o&&"string"==typeof o}static isCustomFont(t){return!!t&&t.hasOwnProperty("fontName")&&t.hasOwnProperty("localName")&&t.hasOwnProperty("url")&&this.isValidCustomFont(t)}static isCustomFontsArray(t){return 0===t.length||t.every(t=>this.isCustomFont(t))}}const runtime=(()=>isChromium?chrome.runtime:browser.runtime)(),sync={get:async(t=null)=>new Promise(e=>{isChromium?chrome.storage.sync.get(t,t=>e(t)):browser.storage.sync.get(t).then(t=>e(t))}),set:async t=>new Promise(e=>{isChromium?chrome.storage.sync.set(t,()=>e()):browser.storage.sync.set(t).then(()=>e())})},tabs={create:async t=>new Promise(e=>{isChromium?chrome.tabs.create({url:t},t=>e(t)):browser.tabs.create({url:t}).then(t=>e(t))}),queryAllTabs:async()=>new Promise(t=>{isChromium?chrome.tabs.query({},e=>t(e)):browser.tabs.query({}).then(e=>t(e))}),queryCurrentTab:async()=>new Promise(t=>{isChromium?chrome.tabs.query({active:!0,currentWindow:!0},e=>t(e)):browser.tabs.query({active:!0,currentWindow:!0}).then(e=>t(e))}),sendMessage(t,e){isChromium?chrome.tabs.sendMessage(t,e):browser.tabs.sendMessage(t,e)}};async function injectCustomFonts(t){let e=get("wudoohCustomFontsStyle");return e&&(e.textContent="",document.head.removeChild(e),e=null),(e=document.createElement("style")).id="wudoohCustomFontsStyle",t.forEach(t=>{e.textContent=e.textContent.concat(CustomFont.injectCSS(t))}),document.head.append(e),t}function get(t){return document.getElementById(t)}function wait(t,e){return setTimeout(e,t)}Array.prototype.contains=function(t){return-1!==this.indexOf(t)},String.prototype.contains=function(t){return-1!==this.indexOf(t)},Element.prototype.postDelayed=function(t,e){let s=wait(t,()=>{s===this.currentTask&&e.call(this)});this.currentTask=s};